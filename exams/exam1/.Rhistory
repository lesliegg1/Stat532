if(theta > 40 & theta <= 60) {out <- 0.05/20}
if(theta > 60 & theta <= 100) {out <- 0.05/40}
return(out)
}
x <- seq(0, 100, by=0.1)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
plot(x, probs, type="l", xlab=expression(lambda), main="Stepwise prior")
#check that it sums to 1
sum(0.1*probs[-c(100)])
prior.fun <- function(theta){
if(theta <= 3) {out <- 0.14/3}
if(theta > 3 & theta <= 7) {out <- 0.21/4}
if(theta > 7 & theta <= 10) {out <- 0.13/3}
if(theta > 10 & theta <= 15) {out <- 0.16/5}
if(theta > 15 & theta <= 20) {out <- 0.1/5}
if(theta > 20 & theta <= 30) {out <- 0.11/10}
if(theta > 30 & theta <= 40) {out <- 0.05/10}
if(theta > 40 & theta <= 60) {out <- 0.05/20}
if(theta > 60 & theta <= 100) {out <- 0.05/40}
return(out)
}
x <- seq(0, 100, by=0.1)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
plot(x, probs, type="l", xlab=expression(lambda), main="Stepwise prior")
#check that it sums to 1
sum(0.1*probs[-c(100)])
.14+.21+.13+.16+0.16+0.1+0.11+0.05+0.05+0.05
.14+.21+.13+.16+0.1+0.1+0.11+0.05+0.05+0.05
.14+.21+.13+.16+0.1+0.11+0.05+0.05+0.05
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-0*x), lty=3)
x <- seq(1, 60, by=0.01)
plot(x, x^{0-1}*exp(-0*x), type="l", xlab=expression(lambda), ylab="Gam(0, 0)", main="Improper Gamma Prior")
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-0*x), lty=3)
lines(x, dgamma(x, 1, .02))
lines(x, dgamma(x, 1, .000001))
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-0*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Informative Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.01)
plot(x, dgamma(x, 1, .1), type="l", xlab=expression(lambda), ylab="Gam(1, 0.1)", main="Informative Gamma")
x <- seq(1, 100, by=0.01)
plot(x, x^{0-1}*exp(-0*x), type="l", xlab=expression(lambda), ylab="Gam(0, 0)", main="Improper Gamma Prior")
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-0*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Informative Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
x <- seq(0, 100, by=0.01)
plot(x, x^{0-1}*exp(-0*x), type="l", xlab=expression(lambda), ylab="Gam(0, 0)", main="Improper Gamma Prior")
x <- seq(0, 100, by=0.01)
plot(x, x^{0-1}*exp(-5*x), type="l", xlab=expression(lambda), ylab="Gam(0, 0)", main="Improper Gamma Prior")
plot(x, x^{0}*exp(-0*x), type="l", xlab=expression(lambda), ylab="Gam(0, 0)", main="Improper Gamma Prior")
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(1, 0)", main="Improper Gamma Prior")
x <- seq(0, 100, by=0.01)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(1, 0)", main="Improper Gamma Prior", ylim=c(0,20))
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Informative Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(1, 0)", main="Improper Gamma Prior", ylim=c(0,20))
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(1, 0)", main="Improper Gamma Prior")
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(0, 1)", main="Improper Gamma Prior")
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Informative Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(0, 1)", main="Improper Gamma Prior")
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(0, 1)", main="Improper Gamma Prior", ylim=c(0,1))
x <- seq(0, 100, by=0.1)
plot(x, x^{0-1}*exp(-1*x), type="l", xlab=expression(lambda), ylab="Gam(0, 1)", main="Improper Gamma Prior", ylim=c(0,0.05))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors")
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.07))
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06))
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(70, 0.03, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06))
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(50, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5))
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06))
lines(x, dgamma(x, 1, 0.1), lty=2)
lines(x, x^{0-1}*exp(-1*x), lty=3)
lines(x, dgamma(x, 1, .02), lty=4)
lines(x, dgamma(x, 1, .000001), lty=5)
legend(50, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5), cex=0.9)
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06), lwd=2)
lines(x, dgamma(x, 1, 0.1), lty=2, lwd=2)
lines(x, x^{0-1}*exp(-1*x), lty=3, lwd=2)
lines(x, dgamma(x, 1, .02), lty=4, lwd=2)
lines(x, dgamma(x, 1, .000001), lty=5, lwd=2)
legend(50, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5), cex=0.9)
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06), lwd=2)
lines(x, dgamma(x, 1, 0.1), lty=2, lwd=2)
lines(x, x^{0-1}*exp(-1*x), lty=3, lwd=2)
lines(x, dgamma(x, 1, .02), lty=4, lwd=2)
lines(x, dgamma(x, 1, .000001), lty=5, lwd=2)
legend(50, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5), lwd=c(2,2,2,2,2) cex=0.9)
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06), lwd=2)
lines(x, dgamma(x, 1, 0.1), lty=2, lwd=2)
lines(x, x^{0-1}*exp(-1*x), lty=3, lwd=2)
lines(x, dgamma(x, 1, .02), lty=4, lwd=2)
lines(x, dgamma(x, 1, .000001), lty=5, lwd=2)
legend(50, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5), lwd=c(2,2,2,2,2), cex=0.9)
x <- seq(0, 100, by=0.1)
plot(x, probs, type="l", xlab=expression(lambda), main="All priors", ylim=c(0, 0.06), lwd=2)
lines(x, dgamma(x, 1, 0.1), lty=2, lwd=2)
lines(x, x^{0-1}*exp(-1*x), lty=3, lwd=2)
lines(x, dgamma(x, 1, .02), lty=4, lwd=2)
lines(x, dgamma(x, 1, .000001), lty=5, lwd=2)
legend(40, 0.05, c("Stepwise", "Informative Proper", "Improper", "Weakly Informative", "Non-informative"), lty=c(1,2,3,4,5), lwd=c(2,2,2,2,2), cex=0.9)
1/6
.19+.25+.23+0.17+0.1+0.05
.19+.25+.23+0.17+0.1+0.06
.03+.16+.23+.25+.17+.10+.06
plot(extinctions)
is.factor(extinctions$island)
extinctions$island <- as.factor(extinctions$island)
plot(extinctions)
is.factor(extinctions$extinct)
plot(island, extinct, data=extinctions, type="b")
with(extinctions, plot(island, extinct, type="b"))
extinctions$island <- as.factor(extinctions$island)
extinctions$extinct <- as.factor(extinctions$extinct)
with(extinctions, plot(island, extinct, type="b"))
extinctions <- read.csv("~/Documents/Stat532/exams/exam1/Extinctions.csv", head=T)
extinctions <- read.csv("~/Documents/Stat532/exams/exam1/Extinctions.csv", head=T)
with(extinctions, plot(island, extinct, type="b"))
with(extinctions, plot(island, extinct, type="b"), xlab="Island", ylab="Number Extinct", "Number extinct in the decade")
with(extinctions, plot(island, extinct, type="b"), xlab="Island", ylab="Number Extinct", main="Number Extinct Bird Species 1949-1959")
with(extinctions, plot(island, extinct, type="b", xlab="Island", ylab="Number Extinct", main="Number Extinct Bird Species 1949-1959"))
length(extinctions$extinct)
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
like.pois(0:50)
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
lambda <- seq(0, 100, by=0.1)
plot(lambda, like.pois(lambda))
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
lambda <- seq(0, 100, by=0.1)
plot(lambda, like.pois(lambda), type="l")
lambda <- seq(0, 100, by=0.01)
num.int <- sum(0.01*like.pois(lambda))
plot(lambda, like.pois(lambda)/num.int, type="l")
lambda <- seq(0, 50, by=0.001)
num.int <- sum(0.001*like.pois(lambda))
plot(lambda, like.pois(lambda)/num.int, type="l")
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=paste(expression("Normalized likelihood function of "lambda)))
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ")lambda))
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ", lambda)))
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
lambda <- seq(0, 50, by=0.001)
num.int <- sum(0.001*like.pois(lambda))
par(mfrow=c(1,2))
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ", lambda)))
with(extinctions, plot(island, extinct, type="b", xlab="Island", ylab="Number Extinct", main="Number Extinct Bird Species 1949-1959"))
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
lambda <- seq(0, 50, by=0.001)
num.int <- sum(0.001*like.pois(lambda))
par(mfrow=c(1,2))
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ", lambda)))
with(extinctions, plot(island, extinct, type="b", xlab="Island", ylab="Number Extinct", main="Number Extinct Bird Species 1949-1959"))
sum(extinctions(extinct))
sum(extinctions$extinct)
length(extinctions$extinct)
x <- seq(0, 100, by=0.1)
input <- data.frame(x)
x <- seq(0, 100, by=0.1)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
sample(x, prob=probs)
post.in <- sample(x, prob=probs)
post.out <- like.fun(post.in)
post.out <- like.pois(post.in)
post.out
plot(x, post.out)
post.in <- sample(x, prob=probs)
x <- seq(0, 50, by=0.01)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
post.in
plot(post.in, post.out)
plot(post.in, post.out/num.intpost)
num.intpost <- sum(0.01*post.out)
plot(post.in, post.out/num.intpost)
x <- seq(0, 20, by=0.001)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
num.intpost <- sum(0.001*post.out)
plot(post.in, post.out/num.intpost, type="l")
plot(post.in, post.out, type="l")
x <- seq(0, 20, by=0.001)
input <- data.frame(x)
input
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.in
probs
x <- seq(0, 50, by=0.01)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
num.intpost <- sum(0.01*post.out)
plot(post.in, post.out, type="l")
x <- seq(0, 50, by=0.01)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
num.intpost <- sum(0.01*post.out)
plot(post.in, post.out)
x <- seq(0, 20, by=0.001)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
num.intpost <- sum(0.001*post.out)
plot(post.in, post.out/num.intpost)
post.in
plot(post.in, post.out/num.intpost, type="l")
plot(post.in, post.out/num.intpost)
plot.frame <- cbind.data.frame(post.in, post.out)
with(plot.frame, plot(post.in, post.out, type="l"))
head(plot.frame)
plot.frame <- cbind.data.frame(post.in, post.out/numint.post)
numint.post <- sum(0.001*post.out)
plot.frame <- cbind.data.frame(post.in, post.out/numint.post)
head(plot.frame)
extinctions
head(plot.frame)
plot.frame <- cbind.data.frame(post.in, out=post.out/numint.post)
with(plot.frame, plot(post.in, out=post.out, type="l"))
plot.frame <- cbind.data.frame(post.in, out=post.out/numint.post)
with(plot.frame, plot(post.in, out, type="l"))
head(plot.frame)
with(plot.frame, plot(post.in, out, type="l"))
plot.frame <- cbind.data.frame(post.in, out=post.out/numint.post)
with(plot.frame, plot(post.in, out, type="b"))
plot(post.in, post.out/numint.post)
plot(post.in, post.out/numint.post, cex=0.1)
lines(x, like.pois(x))
lines(x, like.pois(x)/num.int)
plot(post.in, post.out/numint.post, cex=0.1)
lines(x, like.pois(x)/num.int)
lines(x, like.pois(lambda)/num.int)
lines(lambda, like.pois(lambda)/num.int)
x <- seq(0, 50, by=0.001)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
post.in <- sample(x, prob=probs)
post.out <- like.pois(post.in)
numint.post <- sum(0.001*post.out)
plot(post.in, post.out/numint.post, cex=0.1)
lines(x, like.pois(x)/num.int)
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ", lambda)))
points(post.in, post.out/numint.post, cex=0.1)
plot(lambda, like.pois(lambda)/num.int, type="l", xlab=expression(lambda), ylab="Normalized Likelihood", main=expression(paste("Normalized likelihood function of ", lambda)))
points(post.in, post.out/numint.post, cex=0.01, pch=2)
post.in
hist(post.in)
hist(post.in, freq=FALSE)
post.in <- sample(x, size=1000, prob=probs, replace=TRUE)
hist(post.in)
post.out <- like.pois(post.in)*post.in
post.out
head(post.in)
head(like.pois(post.in))
head(post.out)
6.87*10^{-25}*9.608
6.87*10^{-26}*9.608
hist(post.in)
lines(x, probs)
hist(post.in, freq=F)
lines(x, probs)
lines(x, probs, lty=2, lwd=3)
hist(post.in, freq=F, nclass=20)
lines(x, probs, lty=2, lwd=3)
lines(x, probs, lty=2, lwd=3, col="red")
prior.samp <- sample(x, size=1000, prob=probs, replace=TRUE)
table(prior.samp)
freq(prior.samp)
post.out <- like.pois(post.in)*prior.samp
hist(post.out)
hist(post.out, nclass=100)
hist(post.out/numint.post)
post.out <- like.pois(prior.samp)
hist(post.out)
numint.post <- sum(0.001*post.out)
hist(post.out/numint.post)
post.out/numint.post
post <- post.out/numint.post
table(post
)
plot(table(post))
post.fun <- function(x) {
prior.fun(x)*like.pois(x)
}
post.fun(10)
post.fun <- function(lambda) {
prior.fun(lambda)*like.pois(lambda)
}
post.fun(lambda)
post.fun(3)
post.fun(10)
post.fun(50)
post.fun(20)
x <- seq(0, 50, by=0.001)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
prior.samp <- sample(x, size=1000, prob=probs, replace=TRUE)
hist(prior.samp, freq=F, nclass=20)
lines(x, probs, lty=2, lwd=3, col="red")
post.fun(1:10)
x <- seq(0, 50, by=0.001)
input <- data.frame(x)
probs <- apply(input, 1, prior.fun)
prior.samp <- sample(x, size=1000, prob=probs, replace=TRUE)
hist(prior.samp, freq=F, nclass=20)
lines(x, probs, lty=2, lwd=3, col="red")
post.fun <- function(lambda) {
prior.fun(lambda)*like.pois(lambda)
}
numint.post <- sum(0.001*post.fun(x))
post <- post.fun(x)/numint.post
plot(x, post, type="l")
lines(x, like.pois(x)/num.int)
plot(x, post, type="l")
lines(x, like.pois(x)/num.int, lty=3)
post.fun <- function(lambda) {
prior.fun(lambda)*like.pois(lambda)
}
numint.post <- sum(0.001*post.fun(lambda))
post <- post.fun(lambda)/numint.post
hist(post.out/numint.post)
plot(x, post, type="l")
lines(x, like.pois(x)/num.int, lty=3, col="red")
plot(lambda, post, type="l")
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red")
plot(lambda, post, type="l", xlim=c(0, 20))
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red")
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=3)
post
post-like.pois(lambda)/num.int
sum(post-like.pois(lambda)/num.int)
lines(lambda, dgamma(lambda, 109, 18.1))
plot(lambda, post, type="l", xlim=c(3,10))
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=3)
lines(lambda, dgamma(lambda, 109, 18.1))
plot(lambda, post, type="l", xlim=c(3,10))
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=3)
lines(lambda, dgamma(lambda, 109, 18.1), lty=4)
posterior <- post.fun(lambda)/numint.post
hist(posterior)
#Write a function to calculate the posterior probability for each value of lambda
post.fun <- function(lambda) {
prior.fun(lambda)*like.pois(lambda)
}
#Look at lambdas between 0 and 50
lambda <- seq(0, 50, by=0.001)
#Normalize the posterior distribution
numint.post <- sum(0.001*post.fun(lambda))
post.probs <- post.fun(lambda)/numint.post
#plot the posterior and the likelihood
plot(lambda, post.probs, type="l", xlim=c(3,10))
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=3)
plot(lambda, post.probs, type="l", xlim=c(3,10), lwd=3)
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=3)
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=5)
plot(lambda, post.probs, type="l", xlim=c(3,10), lwd=2, xlab=expression(lambda), ylab="Posterior Probabilities", main="Posterior Distribution Starting from Stepwise Prior")
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=4)
extinctions
mean(extinctions$extinct)
legend(9, 0.5, c("Posterior", "Likelihood"), lty=c(1, 3), lwd=c(2,3))
legend(7.5, 0.5, c("Posterior", "Likelihood"), lty=c(1, 3), lwd=c(2,3), cex=0.9)
plot(lambda, post.probs, type="l", xlim=c(3,10), lwd=2, xlab=expression(lambda), ylab="Posterior Probabilities", main="Posterior Distribution Starting from Stepwise Prior")
lines(lambda, like.pois(lambda)/num.int, lty=3, col="red", lwd=4)
legend(7.5, 0.5, c("Posterior", "Likelihood"), lty=c(1, 3), lwd=c(2,3), cex=0.9)
legend(7.5, 0.5, c("Posterior", "Likelihood"), lty=c(1, 3), lwd=c(2,3), col=c("black", "red"), cex=0.9)
#likelihood function
like.pois <- function(lambda){
lambda^{sum(extinctions$extinct)}*exp(-18*lambda)/prod(factorial(extinctions$extinct))
}
#Write a function to calculate the posterior probability for each value of lambda
post.fun <- function(lambda) {
prior.fun(lambda)*like.pois(lambda)
}
#Look at lambdas between 0 and 10
lambda <- seq(0, 10, by=0.001)
#Normalize the posterior distribution
numint.post <- sum(0.001*post.fun(lambda))
post.probs <- post.fun(lambda)/numint.post
quantile(post.probs, 0.005)
sample(lambda, 1000, prob=post.probs, replace=TRUE)
post.samp <- sample(lambda, 1000, prob=post.probs, replace=TRUE)
quantile(post.probs, 0.005)
quantile(post.samp, 0.005)
post.samp <- sample(lambda, 1000, prob=post.probs, replace=TRUE)
quantile(post.samp, 0.005)
post.samp <- sample(lambda, 10000, prob=post.probs, replace=TRUE)
quantile(post.samp, 0.005)
quantile(post.samp, 0.995)
post.samp <- sample(lambda, 10000, prob=post.probs, replace=TRUE)
quantile(post.samp, 0.005)
quantile(post.samp, 0.995)
set.seed(49)
post.samp <- sample(lambda, 10000, prob=post.probs, replace=TRUE)
quantile(post.samp, 0.005)
quantile(post.samp, 0.995)
1-pdata(post.samp, 5)
require(mosaic, quietly=TRUE)
1-pdata(post.samp, 5)
1-pdata(5, post.samp)
qgamma(0.005, 109, 18.000001)
1-pgamma(5, 109, 18.000001)
pi <- c(qgamma(0.005, 109, 18.000001), 1-qgamma(0.995, 109, 18.000001))
pi
pi <- c(qgamma(0.005, 109, 18.000001), qgamma(0.995, 109, 18.000001))
po
pi
prob.1 <- 1-pgamma(5, 109, 18.000001)
prob.1
pi.2 <- c(qgamma(0.005, 109, 18.02), qgamma(0.995, 109, 18.02))
prob.2 <- 1-pgamma(5, 109, 18.02)
pi.3 <- c(qgamma(0.005, 108, 19), qgamma(0.995, 108, 19))
prob.3 <- 1-pgamma(5, 108, 19)
pi.4 <- c(qgamma(0.005, 109, 18.1), qgamma(0.995, 109, 18.1))
prob.4 <- 1-pgamma(5, 109, 18.1)
pi.1
pi.1
pi.1 <- c(qgamma(0.005, 109, 18.000001), qgamma(0.995, 109, 18.000001))
prob.1 <- 1-pgamma(5, 109, 18.000001)
pi.1
prob.1
pi.2
prob.2
pi.3
prob.3
quantile(post.samp, 0.005)
quantile(post.samp, 0.995)
1-pdata(5, post.samp)
pi.4 <- c(qgamma(0.005, 109, 18.1), qgamma(0.995, 109, 18.1))
prob.4 <- 1-pgamma(5, 109, 18.1)
pi.4
prob.4
extinctions
