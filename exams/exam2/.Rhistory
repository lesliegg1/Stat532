dotR <- file.path(Sys.getenv("HOME"), ".R")
if (!file.exists(dotR)) dir.create(dotR)
M <- file.path(dotR, "Makevars")
if (!file.exists(M)) file.create(M)
cat("\nCXXFLAGS=-O3", file = M, sep = "\n", append = TRUE)
cat("\nCXXFLAGS+=-flto -ffat-lto-objects",
file = M, sep = "\n", append = TRUE)
Sys.setenv(MAKEFLAGS = "-j4")
setwd("~/Documents/Stat532/exams/exam2")
frog.data <- read.csv("FrogDoseData.csv")
frog.data
head(frog.data)
glm.fit <- glm(death ~ dose, data = frog.data, family = "binomial")
summary(glm.fit)
predict(glm.fit)
plot(glm.fit)
plot(frog.data$dose, frog.data$death)
plot(frog.data$dose, frog.data$death)
lines(glm.fit)
abline(glm.fit)
plot(frog.data$dose, logit(frog.data$death))
require(arm)
plot(frog.data$dose, logit(frog.data$death))
logit(0)
logit(1)
plot(frog.data$dose, logit(frog.data$death/5))
abline(glm.fit)
predict(glm.fit)
probs <- invlogit(predict(glm.fit))
plot(death, probs)
with(frog.data, plot(death, probs))
probs
with(frog.data, plot(probs, death))
frog.data
dose1.logit <- logit(sum(death[dose==0.42])/5)
dose1.logit <- with(frog.data, logit(sum(death[dose==0.42])/5))
dose1.logit
dose2.logit <- with(frog.data, logit(sum(death[dose==0.71])/5))
dose2.logit
dose3.logit <- with(frog.data, logit(sum(death[dose==0.98])/5))
dose4.logit <- with(frog.data, logit(sum(death[dose==2.13])/5))
dose3.logit
dose4.logit
plot(c(0.42, 0.71, 0.98, 2.13), c(dose1.logit, dose2.logit, dose3.logit, dose4.logit))
abline(glm.fit)
dose1.logit <- with(frog.data, logit(sum((death[dose==0.42])+0.01)/5))
dose2.logit <- with(frog.data, logit(sum(death[dose==0.71])/5))
dose3.logit <- with(frog.data, logit((sum(death[dose==0.98])-0.01)/5))
dose4.logit <- with(frog.data, logit((sum(death[dose==2.13])-0.01)/5))
plot(c(0.42, 0.71, 0.98, 2.13), c(dose1.logit, dose2.logit, dose3.logit, dose4.logit))
abline(glm.fit)
dose1.logit <- with(frog.data, logit(sum((death[dose==0.42])+0.00001)/5))
dose2.logit <- with(frog.data, logit(sum(death[dose==0.71])/5))
dose3.logit <- with(frog.data, logit((sum(death[dose==0.98])-0.00001)/5))
dose4.logit <- with(frog.data, logit((sum(death[dose==2.13])-0.00001)/5))
plot(c(0.42, 0.71, 0.98, 2.13), c(dose1.logit, dose2.logit, dose3.logit, dose4.logit))
abline(glm.fit)
dose1.logit <- with(frog.data, logit(sum((death[dose==0.42])+0.00000001)/5))
dose2.logit <- with(frog.data, logit(sum(death[dose==0.71])/5))
dose3.logit <- with(frog.data, logit((sum(death[dose==0.98])-0.00000001)/5))
dose4.logit <- with(frog.data, logit((sum(death[dose==2.13])-0.00000001)/5))
plot(c(0.42, 0.71, 0.98, 2.13), c(dose1.logit, dose2.logit, dose3.logit, dose4.logit))
abline(glm.fit)
fitted.probs <- fitted(glm.fit)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
fitted(flm.fit)
fitted(glm.fit)
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(frog.data$dose, emp.prob, pch=1)
dose1 <- with(frog.data, sum((death[dose==0.42])/5)
dose2 <- with(frog.data, sum(death[dose==0.71])/5)
dose3 <- with(frog.data, sum(death[dose==0.98])/5)
dose4 <- with(frog.data, sum(death[dose==2.13])/5)
dose1 <- with(frog.data, sum(death[dose==0.42])/5)
dose2 <- with(frog.data, sum(death[dose==0.71])/5)
dose3 <- with(frog.data, sum(death[dose==0.98])/5)
dose4 <- with(frog.data, sum(death[dose==2.13])/5)
dose1.logit <- with(frog.data, logit(sum((death[dose==0.42])+0.00000001)/5))
dose2.logit <- with(frog.data, logit(sum(death[dose==0.71])/5))
dose3.logit <- with(frog.data, logit((sum(death[dose==0.98])-0.00000001)/5))
dose4.logit <- with(frog.data, logit((sum(death[dose==2.13])-0.00000001)/5))
plot(c(0.42, 0.71, 0.98, 2.13), c(dose1.logit, dose2.logit, dose3.logit, dose4.logit), xlab= "dose", ylab="empirical logits")
abline(glm.fit)
emp.probs <-  c(dose1, dose2, dose3, dose4)
fitted.probs <- fitted(glm.fit)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(frog.data$dose, emp.prob, pch=1)
points(frog.data$dose, emp.probs, pch=1)
emp.probs
points(unique(frog.data$dose), emp.probs, pch=1)
points(unique(frog.data$dose), emp.probs, pch=4)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(unique(frog.data$dose), emp.probs, pch=4, cex=2)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(unique(frog.data$dose), emp.probs, pch=6, cex=2)
points(unique(frog.data$dose), emp.probs, pch=14, cex=1.5)
points(unique(frog.data$dose), emp.probs, pch=15, cex=1.5)
emp.probs <-  c(dose1, dose2, dose3, dose4)
fitted.probs <- fitted(glm.fit)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(unique(frog.data$dose), emp.probs, pch=15, cex=1.5)
summary(glm.fit)
.5+56.97
57.47/78.29
glm.fit <- glm(death ~ dose, data = frog.data, family = "binomial")
require(arm)
dose1 <- with(frog.data, sum(death[dose==0.42])/5)
dose2 <- with(frog.data, sum(death[dose==0.71])/5)
dose3 <- with(frog.data, sum(death[dose==0.98])/5)
dose4 <- with(frog.data, sum(death[dose==2.13])/5)
emp.probs <-  c(dose1, dose2, dose3, dose4)
fitted.probs <- fitted(glm.fit)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(unique(frog.data$dose), emp.probs, pch=15, cex=1.5)
setwd("~/Documents/Stat532/exams/exam2")
frog.data <- read.csv("FrogDoseData.csv")
dose1 <- with(frog.data, sum(death[dose==0.42])/5)
dose2 <- with(frog.data, sum(death[dose==0.71])/5)
require(arm)
glm.fit <- glm(death ~ dose, data = frog.data, family = "binomial")
require(arm)
dose1 <- with(frog.data, sum(death[dose==0.42])/5)
dose2 <- with(frog.data, sum(death[dose==0.71])/5)
dose3 <- with(frog.data, sum(death[dose==0.98])/5)
dose4 <- with(frog.data, sum(death[dose==2.13])/5)
emp.probs <-  c(dose1, dose2, dose3, dose4)
fitted.probs <- fitted(glm.fit)
plot(frog.data$dose, fitted.probs, type="n", ylab="Pr(Death)", xlab="Dose",
main="Fitted Probabilities")
coefs <- coef(glm.fit)
curve(invlogit(coefs[1] + coefs[2]*x),
lwd=2, col=2, add=TRUE)
points(unique(frog.data$dose), emp.probs, pch=15, cex=1.5)
data <- with(frog.data, list(y = death, x = dose, N = length(death)))
model2 <- stan_model(file = "~/Documents/Stat532/exams/exam2/model2.stan",
model_name = "model2")
require(rstan)
data <- with(frog.data, list(y = death, x = dose, N = length(death)))
model2 <- stan_model(file = "~/Documents/Stat532/exams/exam2/model2.stan",
model_name = "model2")
data <- with(frog.data, list(y = death, x = dose, N = length(death)))
model2 <- stan_model(file = "~/Documents/Stat532/exams/exam2/model2.stan",
model_name = "model2")
samp2 <- sampling(model2, chains = 4, iter = 2000, data = data)
pairs(samp2)
head(samp2)
alpha <- extract(samp2)$alpha
hist(alpha, freq = F)
hist(alpha, freq = F)
abline(v=coefs[1], col="red")
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta))
abline(v=coefs[2], col="red", lwd=3)
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=50)
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=50)
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=50)
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=50)
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30)
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30)
abline(v=coefs[2], col="red", lwd=3)
dose.standard <- with(frog.data, (dose - mean(dose))/sd(dose))
dose.standard <- with(frog.data, (dose - mean(dose))/sd(dose))
std.data <- with(frog.data, list(y = death, x = dose.standard, N = length(death)))
std.model2 <- stan_model(file = "~/Documents/Stat532/exams/exam2/model2.stan",
model_name = "std.model2")
std.samp2 <- sampling(std.model2, chains = 4, iter = 2000, data = std.data)
par(mfrow=c(1,2))
alpha <- extract(std.samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(std.samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(std.samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(std.samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(std.samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(std.samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
require(rstan)
dose.standard <- with(frog.data, (dose - mean(dose))/sd(dose))
std.data <- with(frog.data, list(y = death, x = dose.standard, N = length(death)))
std.model2 <- stan_model(file = "~/Documents/Stat532/exams/exam2/model2.stan",
model_name = "std.model2")
std.samp2 <- sampling(std.model2, chains = 4, iter = 2000, data = std.data)
par(mfrow=c(1,2))
alpha <- extract(std.samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(std.samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
par(mfrow=c(1,2))
alpha <- extract(samp2)$alpha
hist(alpha, freq = F, xlab=expression(alpha), nclass=30, main=expression(alpha))
abline(v=coefs[1], col="red", lwd=3)
beta <- extract(samp2)$beta
hist(beta, freq=F, xlab=expression(beta), nclass=30, main= expression(beta))
abline(v=coefs[2], col="red", lwd=3)
